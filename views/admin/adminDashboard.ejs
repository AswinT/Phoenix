<%- include('../partials/admin/sidebar') %>

  <!-- Main Content -->
  <div class="main-content">
    <div class="page-header">
      <div>
        <h1 class="page-title">Dashboard</h1>
        <p class="text-muted mb-0">Welcome back, Admin! Here's what's happening with your store today.</p>
      </div>
    </div>

    <!-- Stats Row -->
    <div class="row g-4 mb-4">
      <!-- Users Stats -->
      <div class="col-sm-6 col-lg-3">
        <div class="stat-card">
          <div class="icon users">
            <i class="ri-user-line"></i>
          </div>
          <h2 class="stat-title">Total Users</h2>
          <p class="stat-value"><%= dashboardStats.totalUsers.value %></p>
          <div class="<%= dashboardStats.totalUsers.growth.isPositive ? 'text-success' : 'text-danger' %> small">
            <i class="ri-arrow-<%= dashboardStats.totalUsers.growth.isPositive ? 'up' : 'down' %>-line"></i>
            <%= dashboardStats.totalUsers.growth.percentage %>% from last month
          </div>
        </div>
      </div>

      <!-- Orders Stats -->
      <div class="col-sm-6 col-lg-3">
        <div class="stat-card">
          <div class="icon orders">
            <i class="ri-shopping-bag-line"></i>
          </div>
          <h2 class="stat-title">Total Orders</h2>
          <p class="stat-value"><%= dashboardStats.totalOrders.value %></p>
          <div class="<%= dashboardStats.totalOrders.growth.isPositive ? 'text-success' : 'text-danger' %> small">
            <i class="ri-arrow-<%= dashboardStats.totalOrders.growth.isPositive ? 'up' : 'down' %>-line"></i>
            <%= dashboardStats.totalOrders.growth.percentage %>% from last month
          </div>
        </div>
      </div>

      <!-- Sales Stats -->
      <div class="col-sm-6 col-lg-3">
        <div class="stat-card">
          <div class="icon sales">
            <i class="ri-currency-line"></i>
          </div>
          <h2 class="stat-title">Total Sales</h2>
          <p class="stat-value"><%= dashboardStats.totalSales.value %></p>
          <div class="<%= dashboardStats.totalSales.growth.isPositive ? 'text-success' : 'text-danger' %> small">
            <i class="ri-arrow-<%= dashboardStats.totalSales.growth.isPositive ? 'up' : 'down' %>-line"></i>
            <%= dashboardStats.totalSales.growth.percentage %>% from last month
          </div>
        </div>
      </div>

      <!-- Pending Stats -->
      <div class="col-sm-6 col-lg-3">
        <div class="stat-card">
          <div class="icon pending">
            <i class="ri-time-line"></i>
          </div>
          <h2 class="stat-title">Pending Orders</h2>
          <p class="stat-value"><%= dashboardStats.pendingOrders.value %></p>
          <div class="<%= dashboardStats.pendingOrders.growth.isPositive ? 'text-danger' : 'text-success' %> small">
            <i class="ri-arrow-<%= dashboardStats.pendingOrders.growth.isPositive ? 'up' : 'down' %>-line"></i>
            <%= dashboardStats.pendingOrders.growth.percentage %>% from last month
          </div>
        </div>
      </div>
    </div>

    <!-- Sales Analysis Section -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="section-header">
          <h2 class="section-title">Sales Analysis</h2>
          <p class="text-muted">Comprehensive overview of your sales performance</p>
        </div>
      </div>
    </div>

    <!-- Sales Analysis Cards Row 1 -->
    <div class="row g-4 mb-4">
      <!-- Today's Sales -->
      <div class="col-sm-6 col-lg-3">
        <div class="sales-card today">
          <div class="sales-icon">
            <i class="ri-calendar-line"></i>
          </div>
          <div class="sales-content">
            <h3 class="sales-title">Today's Sales</h3>
            <p class="sales-value">₹<%= dashboardStats.todaySales || '0' %></p>
            <div class="sales-trend <%= dashboardStats.todayGrowth?.isPositive ? 'positive' : 'negative' %>">
              <i class="ri-arrow-<%= dashboardStats.todayGrowth?.isPositive ? 'up' : 'down' %>-line"></i>
              <span><%= dashboardStats.todayGrowth?.isPositive ? '+' : '-' %><%= dashboardStats.todayGrowth?.percentage || '0' %>% vs yesterday</span>
            </div>
          </div>
        </div>
      </div>

      <!-- This Week's Sales -->
      <div class="col-sm-6 col-lg-3">
        <div class="sales-card week">
          <div class="sales-icon">
            <i class="ri-calendar-week-line"></i>
          </div>
          <div class="sales-content">
            <h3 class="sales-title">This Week</h3>
            <p class="sales-value">₹<%= dashboardStats.weekSales || '0' %></p>
            <div class="sales-trend <%= dashboardStats.weekGrowth?.isPositive ? 'positive' : 'negative' %>">
              <i class="ri-arrow-<%= dashboardStats.weekGrowth?.isPositive ? 'up' : 'down' %>-line"></i>
              <span><%= dashboardStats.weekGrowth?.isPositive ? '+' : '-' %><%= dashboardStats.weekGrowth?.percentage || '0' %>% vs last week</span>
            </div>
          </div>
        </div>
      </div>

      <!-- This Month's Sales -->
      <div class="col-sm-6 col-lg-3">
        <div class="sales-card month">
          <div class="sales-icon">
            <i class="ri-calendar-month-line"></i>
          </div>
          <div class="sales-content">
            <h3 class="sales-title">This Month</h3>
            <p class="sales-value">₹<%= dashboardStats.monthSales || '0' %></p>
            <div class="sales-trend <%= dashboardStats.monthGrowth?.isPositive ? 'positive' : 'negative' %>">
              <i class="ri-arrow-<%= dashboardStats.monthGrowth?.isPositive ? 'up' : 'down' %>-line"></i>
              <span><%= dashboardStats.monthGrowth?.isPositive ? '+' : '-' %><%= dashboardStats.monthGrowth?.percentage || '0' %>% vs last month</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Average Order Value -->
      <div class="col-sm-6 col-lg-3">
        <div class="sales-card aov">
          <div class="sales-icon">
            <i class="ri-shopping-cart-line"></i>
          </div>
          <div class="sales-content">
            <h3 class="sales-title">Avg Order Value</h3>
            <p class="sales-value">₹<%= dashboardStats.avgOrderValue || '0' %></p>
            <div class="sales-trend <%= dashboardStats.avgOrderValueGrowth?.isPositive ? 'positive' : 'negative' %>">
              <i class="ri-arrow-<%= dashboardStats.avgOrderValueGrowth?.isPositive ? 'up' : 'down' %>-line"></i>
              <span><%= dashboardStats.avgOrderValueGrowth?.isPositive ? '+' : '-' %><%= dashboardStats.avgOrderValueGrowth?.percentage || '0' %>% improvement</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sales Analysis Cards Row 2 -->
    <div class="row g-4 mb-4">
      <!-- Top Selling Category -->
      <div class="col-sm-6 col-lg-4">
        <div class="sales-card category">
          <div class="sales-header">
            <div class="sales-icon">
              <i class="ri-star-line"></i>
            </div>
            <h3 class="sales-title">Top Category</h3>
          </div>
          <div class="sales-content">
            <p class="category-name"><%= dashboardStats.topCategory?.name || 'Electronics' %></p>
            <p class="category-sales">₹<%= dashboardStats.topCategory?.sales || '45,230' %> sales</p>
            <div class="category-progress">
              <div class="progress">
                <div class="progress-bar" style="width: <%= dashboardStats.topCategory?.percentage || '65' %>%"></div>
              </div>
              <span class="progress-text"><%= dashboardStats.topCategory?.percentage || '65' %>% of total sales</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Sales Conversion Rate -->
      <div class="col-sm-6 col-lg-4">
        <div class="sales-card conversion">
          <div class="sales-header">
            <div class="sales-icon">
              <i class="ri-target-line"></i>
            </div>
            <h3 class="sales-title">Conversion Rate</h3>
          </div>
          <div class="sales-content">
            <p class="conversion-rate"><%= dashboardStats.conversionRate || '3.2' %>%</p>
            <p class="conversion-details">From <%= dashboardStats.totalVisitors || '1,245' %> visitors</p>
            <div class="sales-trend positive">
              <i class="ri-arrow-up-line"></i>
              <span>+0.8% vs last month</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Revenue Growth -->
      <div class="col-sm-6 col-lg-4">
        <div class="sales-card growth">
          <div class="sales-header">
            <div class="sales-icon">
              <i class="ri-line-chart-line"></i>
            </div>
            <h3 class="sales-title">Revenue Growth</h3>
          </div>
          <div class="sales-content">
            <p class="growth-rate">+<%= dashboardStats.revenueGrowth || '24.5' %>%</p>
            <p class="growth-period">Year over year</p>
            <div class="mini-chart">
              <div class="chart-bars">
                <div class="bar" style="height: 40%"></div>
                <div class="bar" style="height: 60%"></div>
                <div class="bar" style="height: 45%"></div>
                <div class="bar" style="height: 80%"></div>
                <div class="bar" style="height: 70%"></div>
                <div class="bar" style="height: 90%"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sales Analysis Cards Row 3 -->
    <div class="row g-4 mb-4">
      <!-- Payment Methods -->
      <div class="col-lg-6">
        <div class="sales-card payment-methods">
          <div class="sales-header">
            <div class="sales-icon">
              <i class="ri-bank-card-line"></i>
            </div>
            <h3 class="sales-title">Payment Methods</h3>
          </div>
          <div class="sales-content">
            <div class="payment-method">
              <div class="method-info">
                <span class="method-name">Credit/Debit Cards</span>
                <span class="method-percentage"><%= dashboardStats.paymentMethods?.cards || '65' %>%</span>
              </div>
              <div class="method-bar">
                <div class="method-progress" style="width: <%= dashboardStats.paymentMethods?.cards || '65' %>%"></div>
              </div>
            </div>
            <div class="payment-method">
              <div class="method-info">
                <span class="method-name">UPI/Digital Wallets</span>
                <span class="method-percentage"><%= dashboardStats.paymentMethods?.upi || '25' %>%</span>
              </div>
              <div class="method-bar">
                <div class="method-progress" style="width: <%= dashboardStats.paymentMethods?.upi || '25' %>%"></div>
              </div>
            </div>
            <div class="payment-method">
              <div class="method-info">
                <span class="method-name">Cash on Delivery</span>
                <span class="method-percentage"><%= dashboardStats.paymentMethods?.cod || '10' %>%</span>
              </div>
              <div class="method-bar">
                <div class="method-progress" style="width: <%= dashboardStats.paymentMethods?.cod || '10' %>%"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Sales by Region -->
      <div class="col-lg-6">
        <div class="sales-card regions">
          <div class="sales-header">
            <div class="sales-icon">
              <i class="ri-map-pin-line"></i>
            </div>
            <h3 class="sales-title">Top Regions</h3>
          </div>
          <div class="sales-content">
            <div class="region-item">
              <div class="region-info">
                <span class="region-name">Mumbai</span>
                <span class="region-sales">₹<%= dashboardStats.regions?.mumbai || '0' %></span>
              </div>
              <div class="region-trend <%= (dashboardStats.regions?.mumbaiGrowth || 12) >= 0 ? 'positive' : 'negative' %>">
                <%= (dashboardStats.regions?.mumbaiGrowth || 12) >= 0 ? '+' : '' %><%= dashboardStats.regions?.mumbaiGrowth || '12' %>%
              </div>
            </div>
            <div class="region-item">
              <div class="region-info">
                <span class="region-name">Delhi</span>
                <span class="region-sales">₹<%= dashboardStats.regions?.delhi || '0' %></span>
              </div>
              <div class="region-trend <%= (dashboardStats.regions?.delhiGrowth || 8) >= 0 ? 'positive' : 'negative' %>">
                <%= (dashboardStats.regions?.delhiGrowth || 8) >= 0 ? '+' : '' %><%= dashboardStats.regions?.delhiGrowth || '8' %>%
              </div>
            </div>
            <div class="region-item">
              <div class="region-info">
                <span class="region-name">Bangalore</span>
                <span class="region-sales">₹<%= dashboardStats.regions?.bangalore || '0' %></span>
              </div>
              <div class="region-trend <%= (dashboardStats.regions?.bangaloreGrowth || 15) >= 0 ? 'positive' : 'negative' %>">
                <%= (dashboardStats.regions?.bangaloreGrowth || 15) >= 0 ? '+' : '' %><%= dashboardStats.regions?.bangaloreGrowth || '15' %>%
              </div>
            </div>
            <div class="region-item">
              <div class="region-info">
                <span class="region-name">Chennai</span>
                <span class="region-sales">₹<%= dashboardStats.regions?.chennai || '0' %></span>
              </div>
              <div class="region-trend <%= (dashboardStats.regions?.chennaiGrowth || -3) >= 0 ? 'positive' : 'negative' %>">
                <%= (dashboardStats.regions?.chennaiGrowth || -3) >= 0 ? '+' : '' %><%= dashboardStats.regions?.chennaiGrowth || '-3' %>%
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <script>

    // Highlight active link
    const navLinks = document.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
      link.addEventListener('click', function() {
        navLinks.forEach(l => l.classList.remove('active'));
        this.classList.add('active');
      });
    });
  </script>
</body>
</html>